# Media Server Stack

A comprehensive Docker-based media server setup with Plex, *Arr apps, and more.

## Services Included

### Media
- **Plex**: Media server
- **Tautulli**: Plex monitoring and statistics
- **Overseerr**: Content request and discovery
- **Jellyfin**: Alternative open-source media server

### Download Management
- **qBittorrent**: Torrent client (runs behind VPN)
- **Sonarr**: TV show management
- **Radarr**: Movie management
- **Prowlarr**: Indexer management
- **Bazarr**: Subtitle management
- **Recyclarr**: Maintains Sonarr/Radarr configurations
- **FlareSolverr**: Bypass Cloudflare protection

### System & Utilities
- **Traefik**: Reverse proxy and SSL management
- **WireGuard**: VPN service
- **Homepage**: Dashboard for all services
- **Dozzle**: Docker logs viewer
- **Uptime Kuma**: Service monitoring
- **Filebrowser**: File management interface
- **LibreSpeed**: Network speed test
- **ntfy**: Notification service
- **Duplicati**: Backup solution
- **Watchtower**: Automatic Docker container updates

### Additional Tools
- **Vaultwarden**: Password manager
- **n8n**: Workflow automation
- **Ollama**: Local AI models
- **Ollama WebUI**: Web interface for Ollama

## Prerequisites

- Linux or macOS system
- Docker and Docker Compose
- NVIDIA GPU (optional, for hardware transcoding)

## Installation

### 1. Clone the repository

```bash
git clone https://github.com/your-username/media-server.git
cd media-server
```

### 2. Configure environment variables

Create a `.env` file in the root directory:

```bash
cp .env.example .env
```

Edit the file to add your required settings:
- `HOSTNAME`: Your domain name
- `USER_ID` and `GROUP_ID`: Your local user/group IDs (use `id -u` and `id -g`)
- `TIMEZONE`: Your local timezone
- `DATA_ROOT`: Path to your media library
- `DOWNLOAD_ROOT`: Path to your downloads directory
- API keys for various services

### 3. Run the installation script (Ubuntu/Debian only)

```bash
chmod +x install.sh
./install.sh
```

This script installs:
- Docker and Docker Compose
- NVIDIA drivers and container toolkit (for GPU transcoding)

### 4. Start the stack

```bash
docker compose up -d
```

### 5. Update API keys

After initial startup, run:

```bash
chmod +x update-config.sh
./update-config.sh
```

This updates your `.env` file with API keys generated by *Arr applications.

## Access

All services are available at their respective subdomains:
- Main dashboard: `https://media.yourdomain.com`
- Plex: `https://plex.yourdomain.com`
- Sonarr: `https://sonarr.yourdomain.com`
- And so on for each service

## Configuration

### Traefik

Traefik handles reverse proxy and SSL certificate management through Let's Encrypt.

### WireGuard VPN

For security, the download stack (qBittorrent, Sonarr, etc.) runs through the WireGuard VPN. Configure your VPN provider's settings in the `.env` file.

### Media Library Structure

The recommended structure is:
- `/data/media/movies`: Movies
- `/data/media/tv`: TV shows

## Maintenance

### Updates

Watchtower automatically updates containers daily at 4 AM.

For manual updates:

```bash
docker compose pull
docker compose up -d
```

### Backups

Duplicati is included for backups. Configure through its web interface.

## Troubleshooting

- Check container logs: `docker compose logs -f [service-name]`
- Use Dozzle at `https://dozzle.yourdomain.com` for log monitoring
- Restart a service: `docker compose restart [service-name]`

## License

This project is released under the MIT License.